<div [@listStagger] class="card card-padding">
	<!-- Header -->
	<nz-page-header nzBackIcon (nzBack)="goBack()">
		<nz-page-header-title
			>{{ (selectedProject$ | async)?.title }}
			{{ (newProject$ | async)?.title }}</nz-page-header-title
		>
		<nz-page-header-subtitle
			>{{ (selectedProject$ | async)?.type }}
			{{ (newProject$ | async)?.type }}</nz-page-header-subtitle
		>
		<nz-page-header-tags>
			<!-- <nz-tag [nzColor]="'red'">Warning</nz-tag> -->
		</nz-page-header-tags>
		<nz-page-header-extra *ngIf="(selectUiComponents$ | async).isNewProject">
			<button nzShape="circle" nz-button nzType="default" (click)="open()">
				<i nz-icon nzType="save"></i>
			</button>
		</nz-page-header-extra>
	</nz-page-header>
	<!-- Selected Project -->
	<div *ngIf="selectedProject$ | async as selectedProject">
		<ng-container
			add-comp
			[comp]="components[selectedProject['type']]"
			[selectedProject]="selectedProject$"
		></ng-container>
	</div>
	<!-- New Project -->
	<div *ngIf="newProject$ | async as newProject">
		<ng-container
			add-comp
			[comp]="components[newProject['type']]"
			[selectedProject]="selectedProject$"
		>
		</ng-container>
	</div>
	<!-- Loading Tab -->
	<div *ngIf="!(selectedProject$ | async) && !(newProject$ | async)">
		<div class="loading-template">
			<nz-spin nzSimple nzTip="Loading..."></nz-spin>
		</div>
	</div>
</div>

<!-- Setting Drawer -->
<!-- TODO: Move me to a component and import me in here-->
<nz-modal
	*ngIf="selectUiComponents$ | async"
	[(nzVisible)]="isVisible"
	nzTitle="Save Project"
	(nzOnCancel)="handleCancel()"
	[nzOkText]="null"
>
	<div
		nz-row
		nzType="flex"
		nzJustify="space-around"
		nzAlign="middle"
		class="collapse-content"
	>
		<div nz-col nzSpan="24">
			<div nz-row nzGutter="12" [@listStagger]>
				<div
					nz-col
					[nzSpan]="24"
					[nzMd]="24"
					[nzSm]="24"
					[nzXs]="24"
					style="margin-bottom: 10px;"
				>
					<nz-card
						class="card"
						[nzBordered]="false"
						nzTitle="Project Settings"
						[nzExtra]="extraTemplate"
					>
						<!-- Save New Project -->
						<ng-container
							*ngIf="selectedProject$ | async; else newProjectSaveTemplate"
						>
							<!-- edit Project -->
							<app-save-project
								(formData)="saveFormData($event)"
								[selectedProject$]="selectedProject$"
								[selectLoggedInUser]="selectLoggedInUser$ | async"
								[componentSettings]="this.ComponentSettings"
							>
							</app-save-project>
						</ng-container>

						<ng-template #newProjectSaveTemplate>
							<app-save-project
								(formData)="saveFormData($event)"
								[selectedProject$]="selectLoggedInUser$"
								[selectLoggedInUser]="selectLoggedInUser$ | async"
							>
							</app-save-project>
						</ng-template>
					</nz-card>
					<ng-template #extraTemplate> </ng-template>
				</div>
			</div>
			<div
				nz-row
				nzGutter="12"
				[@listStagger]
				*ngIf="selectedProject$ | async as selectedProject"
			>
				<div
					nz-col
					[nzSpan]="24"
					[nzMd]="24"
					[nzSm]="24"
					[nzXs]="24"
					style="margin-bottom: 10px;"
				>
					<nz-card class="card" [nzBordered]="false" nzTitle="Delete Project">
						<button
							nz-button
							nzType="danger"
							(click)="deleteProject(selectedProject)"
						>
							<i nz-icon nzType="delete"></i>Delete
						</button>
					</nz-card>
				</div>
			</div>
		</div>
	</div>
</nz-modal>
